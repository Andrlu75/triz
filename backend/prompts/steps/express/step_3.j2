{# step_3.j2 — Шаг 3 Краткого АРИЗ: Углублённое противоречие (УП) #}
{# Переменные: user_input, problem_title, problem_description, previous_steps, previous_results #}

## Шаг 3 из 7: Углублённое противоречие (УП)

### Контекст задачи:
**Задача:** {{ problem_title | default("") }}

{% if previous_results %}
**Формулировка задачи:** {{ previous_results.task_formulation | default("") }}
**Главная функция:** {{ previous_results.main_function | default("") }}
**Инструмент:** {{ previous_results.instrument | default("") }}
**Объект:** {{ previous_results.object | default("") }}
**Поверхностное противоречие (ПП):** {{ previous_results.surface_contradiction | default("") }}
{% endif %}

{% if previous_steps %}
### Все предыдущие шаги:
{% for step in previous_steps %}
- **Шаг {{ step.step_code }}** ({{ step.title }}): {{ step.validated_result | default(step.llm_output) }}
{% endfor %}
{% endif %}

{% if user_input %}
### Дополнительный ввод пользователя:
{{ user_input }}
{% endif %}

---

### Твоя задача на этом шаге:

**Углублённое противоречие (УП)** — конфликт между двумя требованиями к одному элементу системы (определение 15). УП углубляет ПП, выявляя конкретный элемент (инструмент), в котором сосредоточен конфликт, и конкретное свойство этого элемента, вызывающее одновременно и полезный, и вредный эффект.

**1. Определение конфликтующей пары (правила 5-6)**

Из формулировки задачи (Шаг 1) уточни конфликтующую пару:
- **Инструмент** — элемент ТС, непосредственно выполняющий главную функцию. Это тот элемент, изменение которого позволит устранить конфликт (правило 6). При неясности — выбери тот, который легче изменить.
- **Объект (изделие)** — элемент, на который направлено действие инструмента. Объект изменять запрещено (правило 11).

Между инструментом и объектом должно быть непосредственное физическое взаимодействие (контакт, поле) — правило 5.

**2. Определение конфликтующего свойства**

Найди ключевое свойство инструмента, которое создаёт конфликт:
- **Свойство А** — при наличии этого свойства достигается полезный эффект, но одновременно возникает вредный.
- **Свойство Б (анти-А)** — при наличии противоположного свойства вредный эффект устраняется, но теряется полезный.

Примеры конфликтующих свойств:
- Большой / маленький (размер)
- Горячий / холодный (температура)
- Жёсткий / гибкий (механические свойства)
- Быстрый / медленный (скорость)
- Проницаемый / непроницаемый (структура)

**3. Формулировка двух вариантов УП (правила 16-19)**

Оба варианта обязательны — они являются логическими инверсиями друг друга (правило 17):

**Вариант УП-1:**
> «Если [инструмент] обладает свойством [А], то [достигается конкретный полезный эффект], НО [возникает конкретный вредный эффект]»

**Вариант УП-2:**
> «Если [инструмент] обладает свойством [Б (анти-А)], то [вредный эффект устраняется], НО [полезный эффект теряется]»

Требования к формулировке:
- Указать конкретные полезный и вредный эффекты, а не абстрактные «хорошо/плохо» (правило 16).
- Формулировка должна быть проверяемой (правило 16).
- Свойства А и Б должны быть действительно противоположными.

**4. Проверка формулировок**

Проверь по чеклисту:
- [ ] Указан конкретный инструмент (не абстрактное понятие)?
- [ ] Указан конкретный объект?
- [ ] Являются ли свойства А и Б действительно противоположными?
- [ ] Полезный и вредный эффекты — конкретные, а не абстрактные?
- [ ] Связаны ли эффекты с ГФ системы?
- [ ] Оба варианта УП записаны явно?

Если формулировка затруднена — вернуться к выбору конфликтующей пары и проверить правильность определения инструмента и объекта (правило 18).

---

### Формат ответа:

```
КОНФЛИКТУЮЩАЯ ПАРА:
  Инструмент: ...
  Объект: ...

КОНФЛИКТУЮЩЕЕ СВОЙСТВО: ...
  Свойство А: ...
  Свойство Б (анти-А): ...

УП-1: Если [инструмент] обладает свойством [А], то ..., НО ...
  Полезный эффект: ...
  Вредный эффект: ...

УП-2: Если [инструмент] обладает свойством [Б], то ..., НО ...
  Устранение вреда: ...
  Потеря пользы: ...

ВЫВОД: Ключевой конфликт сосредоточен в [элементе] — его свойство [...] одновременно обеспечивает полезный эффект и порождает вредный.
```
