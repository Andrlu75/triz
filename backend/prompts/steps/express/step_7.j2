{# step_7.j2 — Шаг 7: Решение #}
{# Переменные: user_input, problem_title, problem_description, previous_steps, previous_results #}

## Шаг 7 из 7: Решение

### Полный контекст задачи:
**Задача:** {{ problem_title | default("") }}

{% if previous_results %}
**Формулировка задачи:** {{ previous_results.task_formulation | default("") }}
**Главная функция:** {{ previous_results.main_function | default("") }}
**ПП:** {{ previous_results.surface_contradiction | default("") }}
**УП:** {{ previous_results.deepened_contradiction | default("") }}
**ИКР:** {{ previous_results.ikr | default("") }}
**Усиленный ИКР:** {{ previous_results.strengthened_ikr | default("") }}
**ОП:** {{ previous_results.sharpened_contradiction | default("") }}
**Свойство S / анти-S:** {{ previous_results.property_s | default("") }} / {{ previous_results.anti_property_s | default("") }}
**ОЗ:** {{ previous_results.operative_zone | default("") }}
**ОВ:** {{ previous_results.operative_time | default("") }}
**ВПР:** {{ previous_results.vpr | default("") }}
**Направления разрешения ОП:** {{ previous_results.op_directions | default("") }}
{% endif %}

{% if previous_steps %}
### Все предыдущие шаги:
{% for step in previous_steps %}
- **Шаг {{ step.step_code }}:** {{ step.validated_result | default(step.llm_output) }}
{% endfor %}
{% endif %}

### Дополнительный ввод пользователя:
{{ user_input | default("") }}

---

### Твоя задача на этом шаге:

На основании всего проведённого анализа предложи конкретные решения задачи (правила 27–28).

**1. Генерация решений**
Предложи **2–3 конкретных решения**. Для каждого решения:
- Разрешает ли оно обострённое противоречие (ОП)?
- Соответствует ли оно ИКР (или приближается к нему)?
- Какой принцип разделения использован?
- Какие ВПР задействованы?

**2. Привязка к инструментам ТРИЗ**
Для каждого решения укажи, какой инструмент ТРИЗ использован:
- **Приём устранения ТП** (из 50 приёмов) — укажи номер и название.
- **Стандартное решение** (из 76 стандартов) — укажи класс и номер.
- **Физический / химический / биологический эффект** — укажи какой.
- **Аналогия** — если решение основано на аналогии из другой области.

**3. Оценка решений**
Для каждого решения оцени по 10-балльной шкале:
- **Новизна** (1–10): насколько решение нестандартное, неочевидное.
- **Реализуемость** (1–10): насколько легко внедрить на практике.
- **Идеальность** (1–10): насколько близко к ИКР (минимум затрат, максимум результата).
- **Надёжность** (1–10): насколько решение устойчиво и предсказуемо.

**4. Проверка решений (правило 27)**
Для лучшего решения проверь:
- Не усложняет ли оно систему?
- Не создаёт ли новых противоречий?
- Использует ли оно уже имеющиеся ресурсы (ВПР)?
- Приближает ли оно систему к ИКР?

**5. Обобщение (правило 28)**
- Можно ли обобщить найденное решение для класса аналогичных задач?
- В каких ещё областях может быть применён найденный принцип?

**6. Итоговая рекомендация**
Отранжируй решения и дай рекомендацию: какое решение реализовать в первую очередь и почему.

---

### Формат ответа:

```
### Решение 1: [Название]
  Описание: ...
  Метод ТРИЗ: [приём N / стандарт X.Y / эффект]
  Принцип разделения: [пространство / время / структура / системный переход]
  ВПР: ...
  Новизна: X/10
  Реализуемость: Y/10
  Идеальность: Z/10
  Надёжность: W/10
  Общий балл: (X+Y+Z+W)/4

### Решение 2: [Название]
  ...

### Решение 3: [Название]
  ...

ПРОВЕРКА ЛУЧШЕГО РЕШЕНИЯ:
  Не усложняет систему: ДА/НЕТ
  Нет новых противоречий: ДА/НЕТ
  Использует ВПР: ДА/НЕТ
  Приближает к ИКР: ДА/НЕТ

ОБОБЩЕНИЕ: ...

РЕКОМЕНДАЦИЯ: Реализовать решение N, потому что ...
```
