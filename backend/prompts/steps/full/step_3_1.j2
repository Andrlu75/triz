{# step_3_1.j2 — Full ARIZ Part 3, Step 3.1: Formulate OP at macro level #}
{# Variables: user_input, problem_title, problem_description, previous_steps, previous_results #}

## Часть 3 — Определение ФП и ИКР-2. Шаг 3.1: Физическое противоречие на макроуровне

### Контекст:
**Задача:** {{ problem_title | default("") }}

{% if previous_results %}
**Модель задачи:** {{ previous_results.task_model | default("") }}
**ИКР-1:** {{ previous_results.ikr_1 | default("") }}
**ОЗ:** {{ previous_results.operative_zone | default("") }}
**ОВ:** {{ previous_results.operative_time | default("") }}
**ВПР:** {{ previous_results.vpr | default("") }}
{% endif %}

{% if previous_steps %}
### Предыдущие результаты:
{% for step in previous_steps %}
- **Шаг {{ step.step_code }}:** {{ step.validated_result | default(step.llm_output) }}
{% endfor %}
{% endif %}

### Ввод пользователя:
{{ user_input | default("") }}

---

### Инструкция (правила 19, 22-24):

**Шаг 3.1** — сформулировать физическое противоречие (ФП) на макроуровне.

**1. Формулировка ФП на макроуровне (правило 22):**
> «[Часть элемента в ОЗ] ДОЛЖНА обладать свойством [S], чтобы выполнять [полезное действие], И ДОЛЖНА обладать свойством [анти-S], чтобы [удовлетворять требование ИКР-1 / устранять НЭ].»

**2. Проверка (правила 23-24):**
- Абсолютность: используется «ДОЛЖНА», не «желательно».
- Отсутствие компромисса: S и анти-S взаимоисключающие.
- Конкретность: S — конкретное физическое свойство (температура, размер, жёсткость и т.д.).
- Один элемент: оба требования к одному и тому же элементу.

### Формат ответа:
```
ФП (МАКРОУРОВЕНЬ):
  [Элемент в ОЗ] ДОЛЖЕН обладать свойством [S] = ..., чтобы ...
  И ДОЛЖЕН обладать свойством [анти-S] = ..., чтобы ...

СВОЙСТВО S: ... (конкретный физический параметр)
АНТИ-СВОЙСТВО: ... (противоположный параметр)
ЭЛЕМЕНТ: ...
ПРОВЕРКА: абсолютность — ДА/НЕТ, взаимоисключение — ДА/НЕТ, один элемент — ДА/НЕТ
```
